var M=Object.defineProperty;var R=(e,s,o)=>s in e?M(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o;var w=(e,s,o)=>R(e,typeof s!="symbol"?s+"":s,o);import{j as F,d as U,g as $,i as P,a as k,b as I,o as x,f as u,w as v,A as B,t as N,C as G,F as J,B as j,P as K,s as z,K as V,r as H,_ as Y}from"./index-KKScdRr6.js";const D={crush:(e,s=50)=>{const c=(t,r)=>{let f=r.length,d="";const b=i=>encodeURI(encodeURIComponent(i)).replace(/%../g,"i").length,A=i=>{let a=i.charCodeAt(0),h=i.charCodeAt(i.length-1);return a>=56320&&a<=57343||h>=55296&&h<=56319};let p={};for(let i=2;i<s;i++)for(let a=0;a<t.length-i;++a){let h=t.substr(a,i);if(p[h]||A(h))continue;let E=1;for(let _=t.indexOf(h,a+i);_>=0;++E)_=t.indexOf(h,_+i);E>1&&(p[h]=E)}for(;;){for(;f--&&t.includes(r[f]););if(f<0)break;let i=r[f],a,h=0,E=b(i);for(let y in p){let S=p[y],g=(S-1)*b(y)-(S+1)*E;d.length||(g-=b("")),g<=0?delete p[y]:g>h&&(a=y,h=g)}if(!a)break;t=t.split(a).join(i)+i+a,d=i+d;let _={};for(let y in p){let S=y.split(a).join(i),g=0;for(let O=t.indexOf(S);O>=0;++g)O=t.indexOf(S,O+S.length);g>1&&(_[S]=g)}p=_}return{a:t,b:d}};let n=[];const l="-_.!~*'()";for(let t=127;--t;)(t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||l.includes(String.fromCharCode(t)))&&n.push(String.fromCharCode(t));for(let t=32;t<255;++t){let r=String.fromCharCode(t);r!="\\"&&!n.includes(r)&&n.unshift(r)}e=e.replace(new RegExp("","g"),""),e=T(e);const C=c(e,n);let m=C.a;return C.b.length&&(m+=""+C.b),m+="_",m},uncrush:e=>{e=e.substring(0,e.length-1);const s=e.split("");let o=s[0];if(s.length>1){let c=s[1];for(let n of c){let l=o.split(n);o=l.join(l.pop())}}return T(o,0)}},T=(e,s=1)=>{const o=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],c=(n,l)=>{let C=new RegExp(`${(l[2]?l[2]:"")+l[0]}|${(l[3]?l[3]:"")+l[1]}`,"g");return n.replace(C,m=>m===l[0]?l[1]:l[0])};if(s)for(let n=0;n<o.length;++n)e=c(e,o[n]);else for(let n=o.length;n--;)e=c(e,o[n]);return e},L="default entry";class Z{constructor(s,o){w(this,"store");this.localStoreKey=s,this.zeroConfig=o,this.store=F({configs:[],selected:0}),this.load()}get selectedConfig(){return this.store.configs[this.store.selected].value}load(){const s=JSON.parse(localStorage.getItem(this.localStoreKey)||"{}");if(s){if(s.configs){Object.assign(this.store,s);return}localStorage.removeItem(this.localStoreKey)}this.add(this.zeroConfig)}save(){localStorage.setItem(this.localStoreKey,JSON.stringify(this.store))}removeSelected(){if(this.store.configs.splice(this.store.selected,1),this.store.configs.length==0){this.add(this.zeroConfig);return}this.store.selected=this.store.configs.length-1}add(s,{temporary:o}={temporary:!1}){let c=0,n;do n=c?`${L} #${c}`:L,c++;while(this.store.configs.length&&this.store.configs.some(l=>l.name==n));this.store.configs=[...this.store.configs,{name:n,value:s}],this.store.selected=this.store.configs.length-1,o||this.save()}static stringifyUrl(s){const o=JSON.stringify(s);return D.crush(o)}static parseUrl(s){return JSON.parse(D.uncrush(s))}}const q={class:"container"},Q={class:"config-category"},W={class:"flex-end"},X={class:"select"},ee={class:"name"},te=["value"],se={class:"input"},oe={class:"name"},ne=["placeholder"],le={class:"flex-end margin-bottom"},ie=U({__name:"MultiConfigGUI",props:{instance:{},onCreateNew:{type:Function},dataToString:{}},setup(e){const s=z(),{t:o}=$(),c=e,n=P({text:o("COPY"),color:"yellow"}),l=k(()=>`${location.origin}${location.pathname}`);function C(){const t=Z.stringifyUrl(c.dataToString??c.instance.selectedConfig);navigator.clipboard.writeText(`${l.value}?d=${t}`).then(()=>{n.value={text:o("COPIED"),color:"green"},setTimeout(()=>n.value={text:o("COPY"),color:"yellow"},2e3)}).catch(r=>{n.value={text:o("TID_DLG_TITLE_ERROR"),color:"red"},alert(r.message),console.error(r)})}async function m(){const{name:t}=c.instance.store.configs[c.instance.store.selected];await s.dispatch(V.OPEN_CONFIRM,o("REMOVE_CONFIG",[t])).then(()=>{c.instance.removeSelected()}).catch(()=>{})}return(t,r)=>{const f=H("t");return x(),I("div",q,[u("div",Q,[v(u("p",null,null,512),[[f,"CONFIG"]]),u("div",W,[u("button",{class:B(`button ${n.value.color}`),onClick:C},N(n.value.text),3),v(u("button",{class:"button green",onClick:r[0]||(r[0]=(...d)=>e.onCreateNew&&e.onCreateNew(...d))},null,512),[[f,"CREATE"]])])]),u("div",X,[v(u("p",ee,null,512),[[f,"LIST"]]),v(u("select",{"onUpdate:modelValue":r[1]||(r[1]=d=>e.instance.store.selected=d)},[(x(!0),I(J,null,j(e.instance.store.configs,(d,b)=>(x(),I("option",{key:b,value:b},N(d.name),9,te))),128))],512),[[G,e.instance.store.selected]])]),u("div",se,[v(u("p",oe,null,512),[[f,"TID_CHANGE_NAME_TITLE"]]),v(u("input",{"onUpdate:modelValue":r[2]||(r[2]=d=>e.instance.store.configs[e.instance.store.selected].name=d),placeholder:t.$t("TID_CORP_NAME_LABEL")},null,8,ne),[[K,e.instance.store.configs[e.instance.store.selected].name]])]),u("div",le,[v(u("button",{class:"button red",onClick:m},null,512),[[f,"TID_SOCIAL_DELETE_MESSAGE"]])])])}}}),ae=Y(ie,[["__scopeId","data-v-fdcb7439"]]);export{Z as M,ae as a};
