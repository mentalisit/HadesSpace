import{d as te,g as ae,i as S,j as le,S as x,y as se,G as oe,z as ne,b as n,f as l,e as y,O as ue,u as i,t as v,h as B,m as re,M as R,s as ie,r as ce,o as u,I as de,F as f,B as _,w as $,A as I,D as me,x as pe,l as ve,_ as fe}from"./index-KKScdRr6.js";import{m as w,g as ye,a as _e}from"./ModulePage.vue_vue_type_script_setup_true_lang-DSm0NpjV.js";import{C as Ce}from"./Calculator-D28LDse3.js";import{T as Le}from"./TechList-M8Df3MCW.js";import{N as ge}from"./NumberPicker-C0PRRcMK.js";import{c as ke}from"./compendiumTechList-DZKAvOob.js";import{g as Se,s as be}from"./globals-CXCjQ2-e.js";import{b as Te}from"./byTypes-DiOuyN-I.js";import{o as V}from"./Data-BKl5GaN3.js";import"./Page-Cia_DmrK.js";import"./MultiConfigGUI-BS-hSYmF.js";import"./capital_ships-BdRvDN1z.js";import"./spacebuildings-CVaBZ2bu.js";import"./sec2str-CJPGO1m_.js";const he={class:"container"},Me={class:"comp-btn"},Ie={class:"tech-list-wrap"},Ne={class:"modal-module"},Ee={class:"title"},Ue={class:"reset-buttons"},Ae={class:"chars"},Oe={class:"level-picker"},De={key:0},Pe={class:"select"},je={class:"name"},xe=["value"],Be=["value"],Re=te({__name:"ModulesCalc",setup($e){const z=["UnlockPrice","UnlockTime"],H={actually:"CURRENT_LVL",plan:"PLAN_LVL"},b=ie(),{t:q}=ae(),{data:G,levelMap:F,setTechLevel:Y}=ke(),{MaxModuleLevel:C}=Se,K=V(w,{map:([t])=>[t,C]}),X=V(w,{map:(([t,a])=>[t,ye(a)])}),Z=S({}),d=S({actually:{},plan:{}}),g=S(!1),T=S(!1),s=le({size:x.SMALL,title:q("TID_TECH_DLG_TITLE"),data:{module:{},minLevel:0,maxLevel:0,get key(){return this.module.Name}}});let o;se(async()=>{await oe()}),ne([F,()=>b.state.userSettings.compendiumTechSyncConfigIndex],([t])=>{b.state.userSettings.compendiumTechSyncConfigIndex==o.Config.selected&&(d.value.actually={...t},d.value.plan={...t,...d.value.plan})});function J(t){o=t;for(const a of Te.artifact)Z.value[a]=t.provideGetterElements((...c)=>ee.apply(null,[a,...c]))}function k(t,a){if(b.state.userSettings.compendiumTechSyncConfigIndex==o.Config.selected&&t=="actually"){const c=ve(s.data.key);Y(c,a)}return o.onChangeLvl(t,s.data.key,a)}async function N(t){g.value&&(t.target.name=="all"&&k("actually",0),k("plan",0))}function h(t,a){return o.outputClasses(t,s.data.key,a)}function Q(t){s.data.module=t,s.data.maxLevel=K[t.Name],s.data.minLevel=X[t.Name],g.value=!0}function W(t,a){const c=a.total;return c.result.ReqBank=0,function(e,m){const p=t[e].UnlockPrice,r=Array.isArray(p)?p[m.plan[e]-1]:p;c.result.ReqBank=r>c.result.ReqBank?r:c.result.ReqBank}}function ee(t,...[a,c]){const e=structuredClone(_e(t));return Object.entries(e).map(([m,p])=>{for(const[,r]of Object.entries(p))Array.isArray(r)&&r.length<C&&r.unshift(...Array(C-r.length).fill(0));return c[m]=a(e[m],C),[p,C]})}return(t,a)=>{const c=ce("t");return u(),n("div",null,[l("div",he,[y(Ce,{input:d.value,"onUpdate:input":a[0]||(a[0]=e=>d.value=e),"stack-chars":z,"calc-total":W,"local-storage-key":"modulesCalc","title-key":"MODULES_CALC",onSetup:J},null,8,["input"]),l("div",Me,[i(G)?(u(),n("button",{key:0,class:"button accent",onClick:a[1]||(a[1]=e=>T.value=!0)},v(t.$t("HS_COMPENDIUM")),1)):ue("",!0)]),l("div",Ie,[y(Le,{"on-click":Q,"level-map":d.value.actually,"level-map-alt":d.value.plan,"is-muted":e=>!d.value.plan[e]},null,8,["level-map","level-map-alt","is-muted"])])]),y(R,re({open:g.value,"onUpdate:open":a[2]||(a[2]=e=>g.value=e)},s),{body:B(()=>[l("div",Ne,[l("div",Ee,[l("div",null,[l("h2",null,v(t.$t(s.data.module.TID)),1),l("div",Ue,[l("button",{name:"plan",class:"button yellow",onClick:N},v(t.$t("RESET_PLAN")),1),l("button",{name:"all",class:"button red",onClick:N},v(t.$t("RESET_ALL")),1)])]),y(de,{name:s.data.module.Icon,dir:"game/Modules"},null,8,["name"])]),l("ul",Ae,[(u(!0),n(f,null,_(Object.keys(d.value),e=>(u(),n("li",{key:e,class:"input"},[$(l("span",null,null,512),[[c,H[e]]]),l("div",Oe,[y(ge,{value:d.value[e][s.data.key]||0,min:s.data.minLevel,max:s.data.maxLevel,"onUpdate:value":m=>k(e,m)},null,8,["value","min","max","onUpdate:value"])])]))),128)),a[5]||(a[5]=l("li",null,[l("br")],-1)),(u(!0),n(f,null,_(Object.keys(i(o).output.plan[s.data.key]||{}),e=>{var m,p;return u(),n("li",{key:e,class:I({output:!0,"sub-chars":typeof((p=(m=i(o).output.plan)==null?void 0:m[s.data.key])==null?void 0:p[e])=="object"})},[l("b",null,v(i(o).format.key(e)),1),l("div",null,[(u(!0),n(f,null,_(Object.keys(d.value),r=>{var E,U,A,O;return u(),n("span",{key:r,class:I({...h(r,e),[i(be)(e)]:!0,"stats-style":r=="actually"?!h(r,e).none:!1})},[typeof((U=(E=i(o).output[r])==null?void 0:E[s.data.key])==null?void 0:U[e])=="object"?(u(),n("ul",De,[(u(!0),n(f,null,_(Object.keys(i(o).output[r][s.data.key][e]||{}),L=>(u(),n("li",{key:L,class:"output"},[l("b",null,v(i(o).format.key(L)),1),l("div",null,[(u(!0),n(f,null,_(Object.keys(d.value),M=>{var D,P,j;return u(),n("span",{key:M,class:I(h(M,L))},v(i(o).format.value(L,(j=(P=(D=i(o).output[M])==null?void 0:D[s.data.key])==null?void 0:P[e])==null?void 0:j[L])),3)}),128))])]))),128))])):(u(),n(f,{key:1},[me(v(i(o).format.value(e,(O=(A=i(o).output[r])==null?void 0:A[s.data.key])==null?void 0:O[e])),1)],64))],2)}),128))])],2)}),128))])])]),_:1},16,["open"]),y(R,{open:T.value,"onUpdate:open":a[4]||(a[4]=e=>T.value=e),size:i(x).SMALL,title:t.$t("HS_COMPENDIUM")},{body:B(()=>[l("div",Pe,[$(l("p",je,null,512),[[c,"SYNC"]]),l("select",{value:t.$store.state.userSettings.compendiumTechSyncConfigIndex,onChange:a[3]||(a[3]=e=>t.$store.commit(i(pe).SET_COMPENDIUM_TECH_SYNC_CONFIG_INDEX,parseInt(e.target.value)))},[(u(!0),n(f,null,_(i(o).Config.configs,(e,m)=>(u(),n("option",{key:m,value:m},v(e.name),9,Be))),128))],40,xe)])]),_:1},8,["open","size","title"])])}}}),et=fe(Re,[["__scopeId","data-v-aee2ea5a"]]);export{et as default};
