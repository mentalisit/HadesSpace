var R=Object.defineProperty;var A=(o,s,t)=>s in o?R(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t;var w=(o,s,t)=>(A(o,typeof s!="symbol"?s+"":s,t),t);import{j as F,d as U,x as $,g as P,i as k,a as G,r as B,o as I,b as N,f as u,w as _,C as J,t as D,O as j,F as z,D as K,N as V,P as H,_ as Y}from"./index-BjaG5nMZ.js";const T={crush:(o,s=50)=>{const t="",a=(e,i)=>{let f=i.length,d="";const v=r=>encodeURI(encodeURIComponent(r)).replace(/%../g,"i").length,M=r=>{let c=r.charCodeAt(0),h=r.charCodeAt(r.length-1);return c>=56320&&c<=57343||h>=55296&&h<=56319};let m={};for(let r=2;r<s;r++)for(let c=0;c<e.length-r;++c){let h=e.substr(c,r);if(m[h]||M(h))continue;let y=1;for(let b=e.indexOf(h,c+r);b>=0;++y)b=e.indexOf(h,b+r);y>1&&(m[h]=y)}for(;;){for(;f--&&e.includes(i[f]););if(f<0)break;let r=i[f],c,h=0,y=v(r);for(let O in m){let S=m[O],g=(S-1)*v(O)-(S+1)*y;d.length||(g-=v(t)),g<=0?delete m[O]:g>h&&(c=O,h=g)}if(!c)break;e=e.split(c).join(r)+r+c,d=r+d;let b={};for(let O in m){let S=O.split(c).join(r),g=0;for(let E=e.indexOf(S);E>=0;++g)E=e.indexOf(S,E+S.length);g>1&&(b[S]=g)}m=b}return{a:e,b:d}};let n=[];const l="-_.!~*'()";for(let e=127;--e;)(e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122||l.includes(String.fromCharCode(e)))&&n.push(String.fromCharCode(e));for(let e=32;e<255;++e){let i=String.fromCharCode(e);i!="\\"&&!n.includes(i)&&n.unshift(i)}o=o.replace(new RegExp(t,"g"),""),o=x(o);const p=a(o,n);let C=p.a;return p.b.length&&(C+=t+p.b),C+="_",C},uncrush:o=>{o=o.substring(0,o.length-1);const s=o.split("");let t=s[0];if(s.length>1){let a=s[1];for(let n of a){let l=t.split(n);t=l.join(l.pop())}}return x(t,0)}},x=(o,s=1)=>{const t=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],a=(n,l)=>{let p=new RegExp(`${(l[2]?l[2]:"")+l[0]}|${(l[3]?l[3]:"")+l[1]}`,"g");return n.replace(p,C=>C===l[0]?l[1]:l[0])};if(s)for(let n=0;n<t.length;++n)o=a(o,t[n]);else for(let n=t.length;n--;)o=a(o,t[n]);return o},L="default entry";class Z{constructor(s,t){w(this,"store");this.localStoreKey=s,this.zeroConfig=t,this.store=F({configs:[],selected:0}),this.load()}get selectedConfig(){return this.store.configs[this.store.selected].value}load(){const s=JSON.parse(localStorage.getItem(this.localStoreKey)||"{}");if(s){if(s.configs){Object.assign(this.store,s);return}localStorage.removeItem(this.localStoreKey)}this.add(this.zeroConfig)}save(){localStorage.setItem(this.localStoreKey,JSON.stringify(this.store))}removeSelected(){if(this.store.configs.splice(this.store.selected,1),this.store.configs.length==0){this.add(this.zeroConfig);return}this.store.selected=this.store.configs.length-1}add(s,{temporary:t}={temporary:!1}){let a=0,n;do n=a?`${L} #${a}`:L,a++;while(this.store.configs.length&&this.store.configs.some(l=>l.name==n));this.store.configs=[...this.store.configs,{name:n,value:s}],this.store.selected=this.store.configs.length-1,t||this.save()}static stringifyUrl(s){const t=JSON.stringify(s);return T.crush(t)}static parseUrl(s){return JSON.parse(T.uncrush(s))}}const q={class:"container"},Q={class:"config-category"},W={class:"flex-end"},X={class:"select"},ee={class:"name"},te=["value"],se={class:"input"},oe={class:"name"},ne=["placeholder"],le={class:"flex-end margin-bottom"},re=U({__name:"MultiConfigGUI",props:{instance:{},onCreateNew:{type:Function},dataToString:{}},setup(o){const s=$(),{t}=P(),a=o,n=k({text:t("COPY"),color:"yellow"}),l=G(()=>`${location.origin}${location.pathname}`);function p(){const e=Z.stringifyUrl(a.dataToString??a.instance.selectedConfig);navigator.clipboard.writeText(`${l.value}?d=${e}`).then(()=>{n.value={text:t("COPIED"),color:"green"},setTimeout(()=>n.value={text:t("COPY"),color:"yellow"},2e3)}).catch(i=>{n.value={text:t("TID_DLG_TITLE_ERROR"),color:"red"},alert(i.message),console.error(i)})}async function C(){const{name:e}=a.instance.store.configs[a.instance.store.selected];await s.dispatch(H.OPEN_CONFIRM,t("REMOVE_CONFIG",[e])).then(()=>{a.instance.removeSelected()}).catch(()=>{})}return(e,i)=>{const f=B("t");return I(),N("div",q,[u("div",Q,[_(u("p",null,null,512),[[f,"CONFIG"]]),u("div",W,[u("button",{class:J(`button ${n.value.color}`),onClick:p},D(n.value.text),3),_(u("button",{class:"button green",onClick:i[0]||(i[0]=(...d)=>e.onCreateNew&&e.onCreateNew(...d))},null,512),[[f,"CREATE"]])])]),u("div",X,[_(u("p",ee,null,512),[[f,"LIST"]]),_(u("select",{"onUpdate:modelValue":i[1]||(i[1]=d=>e.instance.store.selected=d)},[(I(!0),N(z,null,K(e.instance.store.configs,(d,v)=>(I(),N("option",{key:v,value:v},D(d.name),9,te))),128))],512),[[j,e.instance.store.selected]])]),u("div",se,[_(u("p",oe,null,512),[[f,"TID_CHANGE_NAME_TITLE"]]),_(u("input",{"onUpdate:modelValue":i[2]||(i[2]=d=>e.instance.store.configs[e.instance.store.selected].name=d),placeholder:e.$t("TID_CORP_NAME_LABEL")},null,8,ne),[[V,e.instance.store.configs[e.instance.store.selected].name]])]),u("div",le,[_(u("button",{class:"button red",onClick:C},null,512),[[f,"TID_SOCIAL_DELETE_MESSAGE"]])])])}}}),ce=Y(re,[["__scopeId","data-v-fdcb7439"]]);export{Z as M,ce as a};
